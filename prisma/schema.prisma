generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model Event {
  id          String   @id @default(cuid())

  // Basic Info
  name        String
  description String
  host        String   // Organizer name

  // Date & Location
  date        DateTime
  endDate     DateTime?
  venue       String
  address     String
  neighborhood String?  // Roma, Condesa, Centro, etc.

  // Pricing
  price       String?  // "Free", "$25", "$25-50", etc.
  ticketUrl   String?  // Link to buy tickets

  // Categorization
  category    String   // gallery, party, performance, talk, exhibition, etc.

  // Media
  imageUrl    String?

  // Monetization
  featured    Boolean  @default(false)

  // Status
  approved    Boolean  @default(false)  // For submissions
  source      String   @default("manual") // manual, submitted, luma, scraped

  // SEO
  slug        String   @unique

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model EmailSubscriber {
  id        String   @id @default(cuid())
  email     String   @unique
  createdAt DateTime @default(now())
}

model EventSubmission {
  id          String   @id @default(cuid())

  // Submitter info
  submitterEmail String
  submitterName  String?

  // Event info (same as Event)
  name        String
  description String
  host        String
  date        DateTime
  venue       String
  address     String
  neighborhood String?
  price       String?
  ticketUrl   String?
  category    String
  imageUrl    String?

  // Status
  status      String   @default("pending") // pending, approved, rejected

  createdAt   DateTime @default(now())
}

model Itinerary {
  id          String   @id @default(cuid())
  slug        String   @unique

  // Owner info (optional until they save)
  email       String?
  name        String?  // e.g. "Sarah's Art Week"

  // Event IDs stored as JSON array
  eventIds    String[] // Array of event IDs

  // Stats for viral tracking
  views       Int      @default(0)
  copies      Int      @default(0)  // How many times copied to new itinerary

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Gallery {
  id          String   @id @default(cuid())

  // Basic Info
  name        String
  slug        String   @unique
  description String

  // Location
  address     String
  neighborhood String  // Roma, Condesa, Centro, etc.

  // Links
  website     String?
  instagram   String?

  // Media
  imageUrl    String?

  // Art Week specific
  artWeekExhibition String?  // Current exhibition during Art Week
  openingDate DateTime?      // Opening reception date if any

  // Status
  featured    Boolean  @default(false)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
